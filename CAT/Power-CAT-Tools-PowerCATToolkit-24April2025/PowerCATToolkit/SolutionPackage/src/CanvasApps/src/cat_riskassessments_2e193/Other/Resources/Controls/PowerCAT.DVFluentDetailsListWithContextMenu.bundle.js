/*! For license information please see bundle.js.LICENSE.txt */
var pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad;(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var a in n)e.o(n,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:n[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{DVFluentDetailsListWithContextMenu:()=>M});const n=FluentUIReactv8290,a=React;var i=e.n(a),o="PowerCATFluentDetailsList",r="sub-text-row-wrapper-break",s="inine-label",l="status-tag",d="text-tag",c="image-button",u="expand-icon",m="celltype-",g=400,h=600,v=" !important";function p(e){return{id:e,key:e,name:"Item "+e,iconName:"Unknown"}}function C(e,t,n){return e.filter((e=>!e.parentItemKey&&!1!==e.visible)).map((a=>f(e,a,t,n)))}function f(e,t,a,i){var o=e.filter((e=>e.parentItemKey===t.key&&e!==t&&!1!==e.visible)).map((t=>f(e,t,a,i))),r={root:{background:"rgba(255, 255, 255,0)"}},s=t.iconName&&{iconName:t.iconName};if(s&&t.iconColor){var l=t.iconColor;s.styles={root:{color:t.iconColor+v}};var d=(0,n.getColorFromString)(l);if(d){var c=(0,n.getShade)(d,n.Shade.Shade8),u={color:(null==c?void 0:c.str)+v};r.iconHovered=u,r.iconPressed=u,r.iconExpanded=u,r.iconChecked=u,r.iconExpandedHovered=u}}var m={key:t.key,text:t.name,disabled:!1===t.enabled||a,onClick:i,iconOnly:!0===t.iconOnly,iconProps:s,canCheck:void 0!==t.checked,checked:t.checked,data:t,buttonStyles:r};return!0===t.isHeader&&o.length>0?(m.itemType=n.ContextualMenuItemType.Section,m.sectionProps={title:t.name,topDivider:t.topDivider,bottomDivider:t.divider,items:o}):!0===t.isHeader?m.itemType=n.ContextualMenuItemType.Header:!0===t.divider?m.itemType=n.ContextualMenuItemType.Divider:(m.itemType=n.ContextualMenuItemType.Normal,m.subMenuProps=o.length>0?{items:o}:void 0),m}var y=a.memo((e=>{var{contextMenuItems:t,item:i,onContextMenuClick:o}=e,[r,s]=a.useState(),l=a.useCallback(((e,n)=>{var a=t.filter((e=>e.key===(null==n?void 0:n.key)));return a&&a.length>0&&o(a[0]),!0}),[t,o]),d=C(t,!1,l);return a.createElement(a.Fragment,null,a.createElement(n.IconButton,{id:"contextMenuButton-".concat(i.getRecordId()),iconProps:{iconName:"MoreVertical"},title:"More actions",ariaLabel:"More actions",onClick:()=>{s({items:d,shouldFocusOnContainer:!0,target:"#contextMenuButton-".concat(i.getRecordId()),onDismiss:()=>s(void 0)})},style:{padding:0,marginTop:"-5px",marginBottom:"-5px"}}),r&&a.createElement(n.ContextualMenu,Object.assign({},r)))}));y.displayName="ContextMenuButton";var S=" !important",b={top:"start",left:"start",bottom:"end",right:"end",center:"center"},x=a.memo((e=>{var t,i,{column:o,item:m,onCellAction:v,onCellMenuAction:p,contextMenuItems:C,expanded:f}=e,x=o,N=a.useCallback((()=>{v(m,x)}),[v,m,x]),E=a.useCallback((e=>{p(m,e,x)}),[p,m,x]),R=a.createElement(a.Fragment,null),k={},w=x.childColumns||[],V=[x,...!1!==f?w:[]];if(V&&V.length>0){V.forEach(((e,t)=>{var n,a=(null===(n=e.subTextRow)||void 0===n?void 0:n.toString())||t;k[a]=k[a]||[],k[a].push(e)}));var O=x.verticalAligned?b[null===(t=x.verticalAligned)||void 0===t?void 0:t.toLowerCase()]:void 0,M={display:"flex",flexDirection:"row",flexWrap:"wrap",height:"end"===O||"center"===O?"100%":void 0,justifyContent:x.horizontalAligned?b[null===(i=x.horizontalAligned)||void 0===i?void 0:i.toLowerCase()]:void 0,alignItems:O},T=Object.keys(k);R=a.createElement("div",{className:(0,n.mergeStyles)(M)},T.map(((e,t)=>{var i=t<T.length-1,o=k[e];return a.createElement(a.Fragment,{key:"childCellRow-"+e.toString()},o.map(((e,t)=>{var{cellContents:i,isBlank:r}=function(e,t,i,o,r){var s,m=a.createElement(a.Fragment,null),g=!1;switch(null===(s=e.cellType)||void 0===s?void 0:s.toLowerCase()){case"expand":m=function(e,t,i){if(e&&e.getValue&&t.fieldName){var o=!0===e.getValue(t.fieldName),r=o?"ChevronUp":"ChevronDown";return a.createElement(n.IconButton,{className:u,ariaLabel:o?"Collapse":"Expand","data-is-focusable":!0,iconProps:{iconName:r},onClick:i})}return a.createElement(a.Fragment,null)}(t,e,o);break;case"image":case"clickableimage":({isBlank:g,cellContents:m}=function(e,t,i){var o,r,s=!0;if(e&&e.getValue){var l=I(t.fieldName,e)[0];if(s=!l||""===l,l){var d=I(t.tagColor,e)[0],u=I(t.ariaTextColumn,e)[0],m=I(t.cellActionDisabledColumn,e)[0],g=function(e,t,i){var o=null,r=e.substring(5);if(e.startsWith("icon:")){var s=t.imageWidth||18,l=(0,n.mergeStyles)({color:i+S,fontSize:s});o=a.createElement(n.FontIcon,{iconName:r,className:l,"aria-hidden":"true"})}else if(e.startsWith("data:")||e.startsWith("https:")){var d=t.imageWidth||32;o=a.createElement(n.Image,{src:e,width:d})}return o}(l,t,d),h=t.imagePadding||void 0;if("clickableimage"===(null===(o=t.cellType)||void 0===o?void 0:o.toLowerCase())){var v="".concat(c," ").concat((0,n.mergeStyles)({padding:h}));r=a.createElement(n.DefaultButton,{onClick:i,className:v,"data-is-focusable":!0,disabled:"True"===m,ariaDescription:u},g)}else{var p=(0,n.mergeStyles)({height:"100%",padding:h,display:"flex"});r=a.createElement("div",{className:p,title:u},g)}}else r=a.createElement(n.DefaultButton,{onClick:i})}else r=a.createElement(a.Fragment,null);return{isBlank:s,cellContents:r}}(t,e,o));break;case"tag":({isBlank:g,cellContents:m}=function(e,t){var i=I(e.fieldName,t)[0],o=I(e.tagColor,t)[0],r=I(e.tagBorderColor,t)[0],s="".concat(d," ").concat((0,n.mergeStyles)({background:o||"#F4F6F7"+S,borderColor:(r||"#CAD0D5")+S})),l=!i||""===i;return{isBlank:l,cellContents:l?a.createElement(a.Fragment,null):a.createElement("span",{className:s,title:i},i)}}(e,t));break;case"indicatortag":({isBlank:g,cellContents:m}=function(e,t){var i=I(e.tagColor,t)[0],o="".concat(l," ").concat((0,n.mergeStyles)({":after":{background:i+S}})),r=I(e.fieldName,t)[0],s=!r||""===r;return{isBlank:s,cellContents:s?a.createElement(a.Fragment,null):a.createElement("span",{className:o,title:r},r)}}(e,t));break;case"link":({isBlank:g,cellContents:m}=function(e,t,i){var o=I(e.fieldName,t)[0],r=!o||""===o;return{isBlank:r,cellContents:r?a.createElement(a.Fragment,null):a.createElement(n.Link,{onClick:i,underline:!0},o)}}(e,t,o));break;case"menu":m=a.createElement(y,{contextMenuItems:i,item:t,onContextMenuClick:e=>{r(e)}});break;default:({cellContents:m,isBlank:g}=function(e,t,n){var i,o=!0;if(e&&t.fieldName){var r=I(t.fieldName,e);if(o=0===r.length||""===r.join(""),r.length>1){var s=t.multiValuesDelimiter||a.createElement("br",null);i=a.createElement(a.Fragment,null,r.map(((e,n)=>{var i=t.firstMultiValueBold&&0===n?a.createElement("b",null,e):e;return a.createElement("span",{key:n},i,n<r.length-1&&s)})))}else i=a.createElement(a.Fragment,null,r[0])}else i=a.createElement(a.Fragment,null);return{cellContents:i,isBlank:o}}(t,e)),g=!0===e.hideWhenBlank&&g}return{cellContents:m,isBlank:g}}(e,m,C,N,E);return function(e,t,i,o){var r=void 0!==t.maxWidth||!0===t.isMultiline,l=void 0;r&&(l=!0===t.isMultiline?"normal":"nowrap");var d={maxWidth:P(r,t.currentWidth||t.maxWidth),textOverflow:P(r,"ellipsis"),overflow:P(r,"hidden"),whiteSpace:l,paddingLeft:P(!i,t.paddingLeft),paddingTop:P(!i,t.paddingTop),paddingRight:P(!i&&o,"4px"),fontWeight:t.isBold?h:g},c=void 0!==t.inlineLabel,u=c&&!0===t.isLabelAbove;return e=i?a.createElement(a.Fragment,null):a.createElement("span",{className:(0,n.mergeStyles)(d),key:t.key.toString()},c&&a.createElement("span",{className:s},t.inlineLabel||t.name),u&&a.createElement("br",null),e)}(i,e,r,t<o.length-1)})),i&&a.createElement("span",{className:r}))})))}return R}));function P(e,t){return e?t:void 0}function I(e,t){var n="";if(e&&t)if(t.getValue){var a=t,i=a.getValue(e);null!==i&&(n=Array.isArray(i)?i:a.getFormattedValue(e))}else n=t[e];return Array.isArray(n)?n.map((e=>e.Value)):[n]}x.displayName="GridCell";var N=i().memo((e=>{var t=e.resources;return i().createElement(n.Overlay,null,i().createElement(n.Stack,{tokens:{padding:8,childrenGap:8},style:{color:"#575757",textAlign:"center"},horizontalAlign:"center"},i().createElement(n.Icon,{iconName:"CheckList",style:{fontSize:40}}),i().createElement(n.Stack.Item,null,t.getString("Message_NoFieldsConfigured")),i().createElement(n.Stack.Item,null,t.getString("Message_ChooseFields"))))}));function E(e){var t=e.getValue("RecordKey");return t?t.toString():e.getRecordId()}N.displayName="NoFields";var R={cellLeftPadding:8,cellRightPadding:8,cellExtraRightPadding:0},k=(e,t)=>e&&t?a.createElement(n.Sticky,{stickyPosition:n.StickyPositionType.Header,stickyClassName:"sticky-header"},t(Object.assign({},e))):null,w=a.memo((e=>{var{records:t,sortedRecordIds:i,datasetColumns:r,columns:s,sortedColumnIds:l,selectionType:d,height:c,itemsLoading:u,selection:g,contextMenuItems:h,onSort:v,onCellAction:p,onCellMenuAction:C,componentRef:f,selectOnFocus:y,sorting:S,overlayOnSort:b,themeJSON:P,alternateRowColor:I,resources:w,columnDatasetNotDefined:O}=e,[M,T]=a.useState(!1),F=a.useCallback(((e,t)=>{if(t&&e&&t.fieldName){!0===b&&T(!0);var n=!!t.isSorted&&!t.isSortedDescending,a=t.data.getValue("ColSortBy")||t.fieldName;v(a,n)}}),[v,T,b]),A=a.useMemo((()=>(T(!1),i.filter((e=>void 0!==e)).map((e=>{var n=t[e];return n&&(n.key=E(n)),n})))),[t,i,T]),{gridColumns:L,expandColumn:D}=a.useMemo((()=>{var e=[],t=[],i=void 0;l.forEach((o=>{var l,d=s[o],c=d.getValue("ColName"),u=r.find((e=>e.name===c));if(u){var g=function(e,t,n){return e&&e.find((e=>e.name===t.name||e.name===n.getFormattedValue("ColSortBy")))}(S,u,d),h=function(e,t,i,o,r){var s,l=y(e.getValue("ColWidth")),d=!0===e.getValue("ColIsBold"),c=null===(s=e.getFormattedValue("ColHorizontalAlign"))||void 0===s?void 0:s.toLowerCase(),u=e.getFormattedValue("ColShowAsSubTextOf"),g=e.getFormattedValue("ColCellType"),h=!0===e.getValue("ColSortable")&&!t.disableSorting,v="";"right"!==c&&"center"!==c||(v=c+"-align");var p,C=g?m+g.toString().toLowerCase():"",f=""!==(p=[v,g?m+g.toString().toLowerCase():""].filter((e=>void 0!==e&&""!==e)).join(" "))?p:void 0;return{key:"col"+e.getRecordId(),name:e.getFormattedValue("ColDisplayName"),fieldName:i,maxWidth:l,minWidth:32,isMultiline:!0===e.getValue("ColMultiLine"),headerPaddingLeft:e.getValue("ColHeaderPaddingLeft"),isSorted:void 0!==o,isSortedDescending:"1"===(null==o?void 0:o.sortDirection.toString()),isResizable:!0===e.getValue("ColResizable"),isFiltered:!1,isBold:d,columnActionsMode:h?n.ColumnActionsMode.clickable:n.ColumnActionsMode.disabled,data:e,className:C,headerClassName:f,tagColor:e.getFormattedValue("ColTagColorColumn"),tagBorderColor:e.getFormattedValue("ColTagBorderColorColumn"),onColumnClick:r,cellType:g,showAsSubTextOf:u,isLabelAbove:!0===e.getValue("ColLabelAbove"),firstMultiValueBold:!0===e.getValue("ColFirstMultiValueBold"),paddingLeft:y(e.getValue("ColPaddingLeft")),paddingTop:y(e.getValue("ColPaddingTop")),multiValuesDelimiter:e.getValue("ColMultiValueDelimiter"),inlineLabel:y(e.getFormattedValue("ColInlineLabel")),hideWhenBlank:!0===e.getValue("ColHideWhenBlank"),subTextRow:e.getValue("ColSubTextRow"),ariaTextColumn:e.getFormattedValue("ColAriaTextColumn"),cellActionDisabledColumn:y(e.getValue("ColCellActionDisabledColumn")),imageWidth:y(e.getValue("ColImageWidth")),imagePadding:y(e.getValue("ColImagePadding")),verticalAligned:y(e.getValue("ColVerticalAlign")),horizontalAligned:y(e.getValue("ColHorizontalAlign")),isRowHeader:!0===e.getValue("ColRowHeader"),onRenderHeader:t=>t?a.createElement("span",{style:{paddingLeft:e.getValue("ColHeaderPaddingLeft")}},t.column.name):null};function y(e){return function(e,t){return e||t}(e,void 0)}}(d,u,c,g,F);h.showAsSubTextOf?t.push(h):e.push(h),"expand"===(null===(l=h.cellType)||void 0===l?void 0:l.toLowerCase())&&(i=h)}}));var o=function(t){var n=e.find((e=>e.fieldName===t.showAsSubTextOf));n&&(n.childColumns||(n.childColumns=[]),n.childColumns.push(t))};for(var d of t)o(d);return{gridColumns:e,expandColumn:i}}),[l,s,r,S,F]),B=a.useCallback(((e,t,n)=>{if(e){var i=e,o=void 0===D||null!=(null==D?void 0:D.fieldName)&&(null==i?void 0:i.getValue)&&!1!==(null==i?void 0:i.getValue(D.fieldName));return a.createElement(x,{column:n,index:t,item:e,onCellAction:p,onCellMenuAction:C,expanded:o,contextMenuItems:h})}return a.createElement(a.Fragment,null)}),[p,C,D,h]),H=a.useCallback((e=>{if(e){var t={};return I&&e.itemIndex%2==0&&(t.root={backgroundColor:I}),a.createElement(n.DetailsRow,Object.assign({},e,{styles:t}))}return null}),[I]),K=a.useMemo((()=>({height:c})),[c]),z=a.useMemo((()=>"set"+L.map((e=>e.fieldName)).join(",")),[L]),W=a.useMemo((()=>({selection:g,disableAutoSelectOnInputElements:!0,selectionMode:d,isSelectedOnFocus:y})),[g,d,y]),_=a.useMemo((()=>{try{return P?(0,n.createTheme)(JSON.parse(P)):void 0}catch(e){console.error("Cannot parse theme",e)}}),[P]),j=function(e,t){return{ariaLabelForGrid:null===e.ariaLabel?void 0:e.ariaLabel,getKey:V,initialFocusedIndex:-1,checkButtonAriaLabel:"select row",onItemInvoked:e.onNavigate,layoutMode:n.DetailsListLayoutMode.fixedColumns,constrainMode:n.ConstrainMode.unconstrained,selectionMode:t,checkboxVisibility:t===n.SelectionMode.none?n.CheckboxVisibility.hidden:e.selectionAlwaysVisible?n.CheckboxVisibility.always:n.CheckboxVisibility.onHover,compact:!0===e.compact,cellStyleProps:R,selectionPreservedOnEmptyClick:!0,useReducedRowRenderer:!0,enableShimmer:e.shimmer,onRenderDetailsHeader:k,isHeaderVisible:e.isHeaderVisible}}(e,d);return a.createElement(n.ThemeProvider,{theme:_,applyTo:"none",style:K,className:o},a.createElement(n.ScrollablePane,{scrollbarVisibility:n.ScrollbarVisibility.auto,scrollContainerFocus:!1},a.createElement(n.ShimmeredDetailsList,Object.assign({},j,{columns:L,onRenderRow:H,onRenderItemColumn:B,items:A,setKey:z,selection:null==W?void 0:W.selection,selectionZoneProps:W,componentRef:f}))),(u||M)&&a.createElement(n.Overlay,null),O&&!u&&a.createElement(N,{resources:w}))}));function V(e,t){var n=e;return e&&n.getRecordId?"row-"+n.getRecordId():e&&n.key?"row-"+n.key:t?"row-"+t.toString():""}w.displayName="Grid";var O={0:n.SelectionMode.none,1:n.SelectionMode.single,2:n.SelectionMode.multiple};class M{constructor(){this.sortedRecordsIds=[],this.sortedColumnsIds=[],this.eventName=void 0,this.eventColumn=void 0,this.eventRowKey=void 0,this.sortColumn=void 0,this.sortDirection=void 0,this.hasSetPageSize=!1,this.scheduledEventOnNextUpdate=!1,this.inputEvent="",this.previousHasPreviousPage=!1,this.previousHasNextPage=!1,this.previousTotalRecords=0,this.previousPageNumber=1,this.pagingEventPending=!1,this.menuItemKey=void 0,this.setSelectedRecords=e=>{try{var t=this.context.parameters.records;t.setSelectedRecordIds(e.filter((e=>void 0!==t.records[e])))}catch(e){console.error("DetailsList: Error when calling setSelectedRecordIds",e)}var n=this.context.parameters.RaiseOnRowSelectionChangeEvent;n&&!0===n.raw&&(this.eventName="OnRowSelectionChange",this.eventRowKey=e&&e.length>0?e[0]:null,this.notifyOutputChanged())},this.onCellAction=(e,t)=>{if(e&&t){this.eventName="CellAction",this.eventColumn=t.fieldName;var n=e.getValue("RecordKey");null===n&&(n=this.sortedRecordsIds.indexOf(e.getRecordId()).toString()),this.eventRowKey=n.toString(),this.notifyOutputChanged()}},this.onCellMenuAction=(e,t,n)=>{if(e&&n){this.eventName="MenuAction",this.eventColumn=n.fieldName;var a=e.getValue("RecordKey");null===a&&(a=this.sortedRecordsIds.indexOf(e.getRecordId()).toString()),this.eventRowKey=a.toString(),this.menuItemKey=null==t?void 0:t.key,this.notifyOutputChanged()}},this.onNavigate=e=>{if(e){var t=e.key,a=this.selection.getItems().indexOf(e),i=O[this.context.parameters.SelectionType.raw];if(i!==n.SelectionMode.none&&t&&(this.selection.setChangeEvents(!1),i===n.SelectionMode.single&&this.selection.setAllSelected(!1),this.selection.setKeySelected(t,!0,!1),this.selection.setChangeEvents(!0,!0),this.ref&&this.ref.forceUpdate()),void 0!==this.eventColumn&&(this.eventName=void 0,this.eventColumn=void 0,this.notifyOutputChanged()),this.context.parameters.records.openDatasetItem(e.getNamedReference()),i===n.SelectionMode.multiple){var o=this.selection.getSelectedIndices();-1===o.indexOf(a)&&o.push(a),this.onSelectionChanged(o)}}},this.onSort=(e,t)=>{if(this.datasetSupportsSorting()){for(var n=this.context.parameters.records.sorting;n.length>0;)n.pop();this.context.parameters.records.sorting.push({name:e,sortDirection:t?1:0}),this.context.parameters.records.refresh()}else this.eventName="Sort",this.sortColumn=e,this.sortDirection=!0===t?"desc":"asc",this.notifyOutputChanged()},this.componentRef=e=>{e&&(this.ref=e)},this.onSelectionChanged=e=>{if(this.selection){var t=this.selection.getItems(),n=e||this.selection.getSelectedIndices(),a=[];n.forEach((e=>{var n=t[e]&&t[e].getRecordId();n&&a.push(n)})),this.setSelectedRecords(a)}},this.canSelectItem=(e,t)=>{var n=!0;return e&&(n=!1!==e.getValue("RecordCanSelect")),n}}init(e,t){this.notifyOutputChanged=t,this.context=e,e.mode.trackContainerResize(!0),this.resources=e.resources,this.selection=new n.Selection({onSelectionChanged:this.onSelectionChanged,canSelectItem:this.canSelectItem}),e.parameters.columns.paging.pageSize!==M.COLUMN_LIMIT&&(e.parameters.columns.paging.setPageSize(M.COLUMN_LIMIT),e.parameters.columns.refresh())}updateView(e){var t=e.parameters.records,n=e.parameters.columns,i=e.parameters.menu;this.setPageSize(e);var o=void 0===this.records;(!t.loading&&!n.loading&&!i.loading&&(e.updatedProperties.indexOf("dataset")>-1||e.updatedProperties.indexOf("records_dataset")>-1||e.updatedProperties.indexOf("columns_dataset")>-1||e.updatedProperties.indexOf("menu_dataset")>-1)||o)&&(this.records||this.setSelectedRecords([]),this.records=t.records,this.sortedRecordsIds=t.sortedRecordIds,this.columns=n.records,this.sortedColumnsIds=n.sortedRecordIds,this.datasetColumns=t.columns,this.menu=function(e){if(e.error||void 0===e.paging.totalResultCount)return[p("1"),p("2"),p("3")];var t={};return e.sortedRecordIds.map((n=>{var a,i,o,r,s,l,d,c,u=e.records[n],m=null!==(a=u.getFormattedValue("ItemKey"))&&void 0!==a?a:"";return void 0!==t[m]?(t[m]++,m+="_".concat(t[m])):t[m]=1,{id:u.getRecordId(),key:m,name:u.getFormattedValue("ItemDisplayName"),enabled:null!==(i=u.getValue("ItemEnabled"))&&void 0!==i?i:void 0,iconName:u.getFormattedValue("ItemIconName"),iconColor:u.getFormattedValue("ItemIconColor"),parentItemKey:u.getFormattedValue("ItemParentKey"),iconOnly:null!==(o=u.getValue("ItemIconOnly"))&&void 0!==o?o:void 0,checked:null!==(r=u.getValue("ItemChecked"))&&void 0!==r?r:void 0,visible:null!==(s=u.getValue("ItemVisible"))&&void 0!==s?s:void 0,isHeader:null!==(l=u.getValue("ItemHeader"))&&void 0!==l?l:void 0,topDivider:null!==(d=u.getValue("ItemTopDivider"))&&void 0!==d?d:void 0,divider:null!==(c=u.getValue("ItemDivider"))&&void 0!==c?c:void 0,data:u}}))}(i),0===t.getSelectedRecordIds().length&&this.selection.count>0&&this.onSelectionChanged(),this.pagingEventPending=!1),this.handleInputEvents(e);var r=a.createElement(w,this.getGridProps(e));return(this.previousHasPreviousPage!==t.paging.hasPreviousPage||this.previousHasNextPage!==t.paging.hasNextPage||this.previousTotalRecords!==t.paging.totalResultCount||this.previousPageNumber!==t.paging.lastPageNumber)&&(this.notifyOutputChanged(),this.previousHasPreviousPage=t.paging.hasPreviousPage,this.previousHasNextPage=t.paging.hasNextPage,this.previousTotalRecords=t.paging.totalResultCount,this.previousPageNumber=t.paging.lastPageNumber),r}getOutputs(){var e=this.context.parameters.records,t={PageNumber:e.paging.lastPageNumber,TotalRecords:this.getTotalRecordCount(),TotalPages:this.getTotalPages(),HasNextPage:e.paging.hasNextPage,HasPreviousPage:e.paging.hasPreviousPage},n={EventName:""};switch(this.eventName){case"Sort":n={EventName:this.eventName,SortEventColumn:this.sortColumn,SortEventDirection:"desc"===this.sortDirection?"1":"0"};break;case"MenuAction":n={EventName:this.eventName,EventColumn:this.eventColumn,EventRowKey:this.eventRowKey,SelectedMenuItemKey:this.menuItemKey};break;case"CellAction":n={EventName:this.eventName,EventColumn:this.eventColumn,EventRowKey:this.eventRowKey};break;case"OnRowSelectionChange":n={EventName:this.eventName,EventRowKey:this.eventRowKey}}return this.eventName="",this.menuItemKey="",Object.assign(Object.assign({},t),n)}destroy(){}getGridProps(e){var t,a,i,o=e.parameters.records,r=e.parameters.columns,s=parseInt(e.mode.allocatedWidth),l=parseInt(e.mode.allocatedHeight),d=this.datasetSupportsSorting()?o.sorting:[{name:null!==(t=e.parameters.CurrentSortColumn.raw)&&void 0!==t?t:"",sortDirection:e.parameters.CurrentSortDirection.raw}],c=!o.loading&&-1===o.paging.totalResultCount,u=this.pagingEventPending||o.loading||r.loading;return c&&this.selection.count>0&&(c=!1,u=!0),{width:s,height:l,visible:e.mode.isVisible,records:this.records,sortedRecordIds:this.sortedRecordsIds,columns:this.columns,datasetColumns:this.datasetColumns,sortedColumnIds:this.sortedColumnsIds,shimmer:c,itemsLoading:u,selection:this.selection,onNavigate:this.onNavigate,onCellAction:this.onCellAction,onCellMenuAction:this.onCellMenuAction,sorting:d,onSort:this.onSort,overlayOnSort:this.datasetSupportsSorting(),selectionType:!0!==e.mode.isControlDisabled?O[e.parameters.SelectionType.raw]:n.SelectionMode.none,componentRef:this.componentRef,selectOnFocus:!0===e.parameters.SelectRowsOnFocus.raw,ariaLabel:this.undefinedIfEmpty(e.parameters.AccessibilityLabel),compact:!0===e.parameters.Compact.raw,contextMenuItems:this.menu,pageSize:e.parameters.PageSize.raw,themeJSON:this.undefinedIfEmpty(e.parameters.Theme),alternateRowColor:this.undefinedIfEmpty(e.parameters.AlternateRowColor),isHeaderVisible:!1!==(null===(a=e.parameters.HeaderVisible)||void 0===a?void 0:a.raw),selectionAlwaysVisible:!0===(null===(i=e.parameters.SelectionAlwaysVisible)||void 0===i?void 0:i.raw),resources:this.resources,columnDatasetNotDefined:r.error&&!r.loading}}setPageSize(e){var t=e.parameters.records;(!this.hasSetPageSize||e.parameters.PageSize.raw&&e.updatedProperties.indexOf("PageSize")>-1)&&(t.paging.setPageSize(e.parameters.PageSize.raw||150),this.hasSetPageSize=!0)}handleInputEvents(e){var t=e.parameters.InputEvent.raw,n=void 0!==t&&t!==this.inputEvent;n&&(this.inputEvent=t);var a=this.scheduledEventOnNextUpdate&&e.updatedProperties&&e.updatedProperties.indexOf("records")>-1;if(t&&(n||a)){if(!this.records||!0===e.parameters.records.loading)return void(this.scheduledEventOnNextUpdate=!0);this.scheduledEventOnNextUpdate=!1,this.handleSelectionEvents(t),this.handleFocusEvents(t),this.handlePagingEvents(t)}}handleSelectionEvents(e){e.indexOf("ClearSelection")>-1?this.asyncOperations((()=>{this.selection.setAllSelected(!1),this.ref&&this.ref.forceUpdate()})):e.indexOf("SetSelection")>-1&&this.asyncOperations((()=>{this.setSelected(),this.ref&&this.ref.forceUpdate()}))}handleFocusEvents(e){if(e.indexOf("SetFocusOnRow")>-1){var t=parseInt(e.substring(13));(void 0===t||isNaN(t))&&(t=0),this.asyncOperations((()=>{this.ref&&this.ref.focusIndex(t)}))}else if(e.indexOf("SetFocusOnHeader")>-1)this.asyncOperations((()=>{this.ref&&this.ref.focusIndex(-1)}));else if(e.indexOf("SetFocus")>-1){var n=this.sortedRecordsIds&&this.sortedRecordsIds.length>0?0:-1;this.asyncOperations((()=>{this.ref&&this.ref.focusIndex(n)}))}}handlePagingEvents(e){e.indexOf("LoadNextPage")>-1?this.loadNextPage():e.indexOf("LoadPreviousPage")>-1?this.loadPreviousPage():e.indexOf("LoadFirstPage")>-1&&this.loadFirstPage()}asyncOperations(e){var t=(0,n.getWindow)(this.container);t&&t.requestAnimationFrame((()=>{setTimeout(e,0)}))}setSelected(){this.selection.setChangeEvents(!1),this.selection.setAllSelected(!1),this.sortedRecordsIds.forEach((e=>{var t=this.records[e];t&&!0===t.getValue("RecordSelected")&&this.selection.setKeySelected(E(t),!0,!1)})),this.selection.setChangeEvents(!0),this.onSelectionChanged()}datasetSupportsSorting(){var e=this.context.parameters.records.getTargetEntityType();return(null==e?void 0:e.length)>0}getTotalRecordCount(){return!0===this.context.parameters.LargeDatasetPaging.raw?-1:this.context.parameters.records.paging.totalResultCount}getTotalPages(){if(!0===this.context.parameters.LargeDatasetPaging.raw)return-1;var e=this.context.parameters.records,t=Math.floor((e.paging.totalResultCount-1)/e.paging.pageSize+1);return Math.max(1,t)}loadFirstPage(){this.context.parameters.records.paging.loadExactPage(1),this.pagingEventPending=!0}loadNextPage(){var e=this.context.parameters.records;this.hasNextPage()&&(e.paging.loadExactPage(e.paging.lastPageNumber+1),this.pagingEventPending=!0)}hasNextPage(){var e=this.context.parameters.records;if(!0===this.context.parameters.LargeDatasetPaging.raw)return e.paging.hasNextPage;var t=this.getTotalPages();return e.paging.lastPageNumber<t}loadPreviousPage(){var e=this.context.parameters.records;e.paging.hasPreviousPage&&(e.paging.loadExactPage(e.paging.lastPageNumber-1),this.pagingEventPending=!0)}undefinedIfEmpty(e){return e.raw&&""!==e.raw?e.raw:void 0}}M.COLUMN_LIMIT=125,pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad=t})();
if (window.ComponentFramework && window.ComponentFramework.registerControl) {
	ComponentFramework.registerControl('PowerCAT.DVFluentDetailsListWithContextMenu', pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad.DVFluentDetailsListWithContextMenu);
} else {
	var PowerCAT = PowerCAT || {};
	PowerCAT.DVFluentDetailsListWithContextMenu = pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad.DVFluentDetailsListWithContextMenu;
	pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad = undefined;
}